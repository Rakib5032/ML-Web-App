<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IoT Threat Mitigation - AI-Powered Security</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='bootstrap.min.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="background-pattern"></div>
    
    <div class="container">
        <div class="header">
            <h1>🛡️ IoT Threat Shield</h1>
            <p>AI-Powered IoT Security & Threat Mitigation System</p>
            
            <div class="stats-bar">
                <div class="stat-item">
                    <span class="stat-number">96%</span>
                    <span class="stat-label">Accuracy</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">&lt;50ms</span>
                    <span class="stat-label">Response Time</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">24/7</span>
                    <span class="stat-label">Protection</span>
                </div>
            </div>
        </div>

        {% if error %}
        <div class="error-alert">
            <strong>Error:</strong> {{ error }}
        </div>
        {% endif %}

        <div class="main-content">
            <div class="form-container">
                <div class="form-header">
                    <h2>Threat Assessment</h2>
                    <p>Enter your IoT system parameters for real-time threat analysis</p>
                </div>

                <form method="POST" id="predictionForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">📊 Data Size (KB)</label>
                            <input type="number" step="any" class="form-input" name="data_size" placeholder="e.g. 525" required>
                        </div>

                        <div class="form-group">
                            <label class="form-label">⏱️ Processing Time (ms)</label>
                            <input type="number" step="any" class="form-input" name="processing_time" placeholder="e.g. 50" required>
                        </div>

                        <div class="form-group full-width">
                            <label class="form-label">🎯 Attack Severity 
                                <span class="range-value" id="attackValue">5</span>
                            </label>
                            <div class="range-container">
                                <input type="range" min="0" max="10" step="1" class="range-input" 
                                       name="attack_severity" id="attackSeverity" value="5" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">⛓️ Blockchain Time (ms)</label>
                            <input type="number" step="any" class="form-input" name="blockchain_time" placeholder="e.g. 115" required>
                        </div>

                        <div class="form-group">
                            <label class="form-label">🔋 Energy Consumption (mJ)</label>
                            <input type="number" step="any" class="form-input" name="energy" placeholder="e.g. 1.10" required>
                        </div>

                        <div class="form-group">
                            <label class="form-label">🏗️ IoT Layer</label>
                            <select class="form-select" name="iot_layer" required>
                                <option value="" disabled selected>Choose Layer</option>
                                <option value="Device">🔧 Device Layer</option>
                                <option value="Network">🌐 Network Layer</option>
                                <option value="Application">📱 Application Layer</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">📡 Request Type</label>
                            <select class="form-select" name="request_type" required>
                                <option value="" disabled selected>Choose Request</option>
                                <option value="Data Transmission">📤 Data Transmission</option>
                                <option value="Encrypted Data Transfer">🔐 Encrypted Transfer</option>
                                <option value="Smart Contract Execution">📋 Smart Contract</option>
                                <option value="Authentication">🔑 Authentication</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">⚠️ Security Threat</label>
                            <select class="form-select" name="threat_type" required>
                                <option value="" disabled selected>Choose Threat</option>
                                <option value="Eavesdropping">👂 Eavesdropping</option>
                                <option value="Man-in-the-Middle">🕵️ Man-in-the-Middle</option>
                                <option value="Tampering">🔧 Tampering</option>
                                <option value="Unauthorized Access">🚫 Unauthorized Access</option>
                                <option value="DDoS">💥 DDoS Attack</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">🔗 Consensus Mechanism</label>
                            <select class="form-select" name="consensus" required>
                                <option value="" disabled selected>Choose Consensus</option>
                                <option value="PoA">🎯 Proof of Authority</option>
                                <option value="PoS">💰 Proof of Stake</option>
                                <option value="PoW">⚡ Proof of Work</option>
                                <option value="PBFT">🛡️ PBFT</option>
                            </select>
                        </div>
                    </div>

                    <button type="submit" class="submit-btn" id="submitBtn">
                        🔍 Analyze Threat Level
                    </button>
                </form>
            </div>

            <div class="info-panel">
                <div class="info-header">
                    <div class="info-icon">🛡️</div>
                    <div class="info-title">Security Insights</div>
                </div>

                <div class="threat-levels">
                    <div class="threat-level">
                        <div class="level-indicator level-low"></div>
                        <div class="level-text">Low Risk (0-2): Minimal threat detected</div>
                    </div>
                    <div class="threat-level">
                        <div class="level-indicator level-medium"></div>
                        <div class="level-text">Medium Risk (3-5): Moderate attention needed</div>
                    </div>
                    <div class="threat-level">
                        <div class="level-indicator level-high"></div>
                        <div class="level-text">High Risk (6-8): Immediate action required</div>
                    </div>
                    <div class="threat-level">
                        <div class="level-indicator level-critical"></div>
                        <div class="level-text">Critical Risk (9-10): Emergency response</div>
                    </div>
                </div>

                <h4 style="color: #2d3748; margin-bottom: 15px; font-size: 1.1rem;">🚀 Key Features</h4>
                <ul class="features-list">
                    <li>Real-time ML-based threat detection</li>
                    <li>Blockchain-secured IoT transactions</li>
                    <li>Multi-layer security analysis</li>
                    <li>Energy-optimized processing</li>
                    <li>Advanced consensus mechanisms</li>
                    <li>Automated mitigation suggestions</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // Slider live value display
        const rangeInput = document.getElementById('attackSeverity');
        const display = document.getElementById('attackValue');
        
        rangeInput.addEventListener('input', () => {
            display.textContent = rangeInput.value;
            
            // Change color based on severity
            const value = parseInt(rangeInput.value);
            if (value <= 2) {
                display.style.background = '#48bb78';
            } else if (value <= 5) {
                display.style.background = '#ed8936';
            } else if (value <= 8) {
                display.style.background = '#f56565';
            } else {
                display.style.background = '#9f7aea';
            }
        });

        // Form submission with loading state
        document.getElementById('predictionForm').addEventListener('submit', function(e) {
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.innerHTML = '🔄 Analyzing...';
            submitBtn.classList.add('loading');
            submitBtn.disabled = true;
        });

        // Clear form on page load
        window.onload = function () {
            document.getElementById("predictionForm").reset();
            display.textContent = '5';
            display.style.background = '#ed8936';
        };

        // Add floating particles effect
        function createParticle() {
            const particle = document.createElement('div');
            particle.style.cssText = `
                position: fixed;
                width: 4px;
                height: 4px;
                background: rgba(255, 255, 255, 0.6);
                border-radius: 50%;
                pointer-events: none;
                left: ${Math.random() * 100}vw;
                top: 100vh;
                animation: float 8s linear infinite;
                z-index: 0;
            `;
            
            document.body.appendChild(particle);
            
            setTimeout(() => {
                particle.remove();
            }, 8000);
        }

        // Add CSS for particle animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes float {
                to {
                    transform: translateY(-100vh) rotate(360deg);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        // Create particles periodically
        setInterval(createParticle, 3000);
    </script>
</body>
</html>